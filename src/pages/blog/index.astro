---
import { getAllPosts, getTopTags } from "@/data/post";
import BlogList from "@/layouts/page/BlogList.astro";
import { collectionDateSort } from "@/utils/date";

const MAX_POSTS_PER_PAGE = 10;
const MAX_TAGS = 7;
const allPosts = await getAllPosts();
const firstPagePostsByDate = allPosts.sort(collectionDateSort).slice(0, MAX_POSTS_PER_PAGE);
const uniqueTags = getTopTags(allPosts, MAX_TAGS);
const nextPageExists = allPosts.length > MAX_POSTS_PER_PAGE;

const page = {
  currentPage: 1,
  url: {
    ...(nextPageExists && {
      next: "/blog/page/2",
    }),
  },
  data: firstPagePostsByDate,
};
---

<BlogList page={page} uniqueTags={uniqueTags} />
